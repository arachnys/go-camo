sudo: required
language: go
go:
  - 1.6
  - 1.7
  - 1.8
  - 1.9
services:
  - docker
install:
  - make setup
script:
  - make test
  - test -n "$TRAVIS_TAG" || make snapshot
after_success:
  - export BUILD_DATE=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
  - export VCS_REF=$(git rev-parse --short HEAD)
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - test -n "$TRAVIS_TAG" && make release
  - if [ "$TRAVIS_PULL_REQUEST" != "false" -o "$TRAVIS_BRANCH" != "master" -o -n "$TRAVIS_TAG" ]; then exit 0; fi
  - docker push arachnysdocker/go-camo
notifications:
  email: false
